## 🚀미션
- 이름 : 김형우
### 개선포인트 분석
- **기존의 코딩 테스트 채점 서버는 EC2 기반 ECS 컨테이너 서비스를 사용하고 있음.**
  - docker priviliged 모드를 사용하여 호스트 권한을 이용해 사용자의 악의적인 소스코드 실행을 보안 처리하기 위해 docker in chroot 로 제어하고 있음.
  - docker priviliged 모드를 사용하면 컨테이너 서버리스 서비스인 Fargate 를 사용할 수 없어서 EC2 기반 컨테이너 서비스를 사용하고 있음.
- **EC2 기반 서비스 이므로, 실시간 오토 스케일링이 유연하지 못함.**
  - 응시자의 제출 요청을 받는 API 서버에서 제출요청을 RabbitMQ 에 적재하고 채점 서버가 메시지를 소비함.
  - MQ의 Ready Count 의 지속 시간에 따른 오토스케일 아웃 지표를 선정함.
    - 실제로 시험이 시작되었는데, 예상치 못한 트래픽으로 인한 서버 처리량이 느려질 경우 채점 서버의 Consumer 에서 RabbitMQ의 메시지 ACK 응답 시간이 길어짐.
  - Ready Count 스케일 아웃 지표를 충족하여 오토 스케일 아웃이 빠르게 진행되기를 기대했지만, EC2 기반이므로 서버가 뜨는데 최소 3분 ~ 최대 5분 정도가 걸림. 
    - 사용자는 소스 코드를 제출 후 상당히 많은 시간을 기다리고 서버상의 장애를 인지하게 됨.
- **실제로, 사용자의 제출 1건에 따른 응답 속도가 크게 다름. (문제마다 테스트 케이스의 갯수 및 용량이 다르기 때문)** 
  - 시험마다 어려운 문제, 쉬운 문제가 어떻게 포진되어 있는지 모르기에 제출 한건에 대한 처리량을 판단하기 힘듦.
    - 서버를 몇 대 띄워야 할지에 대한 적절한 판단 기준이 아직 세워져 있지 않음.
    - 또, 이 문제로 인해 오토 스케일링 지표의 선정 또한 어려움
  - 제출 1건 당 시스템의 리소스를 많이 잡아 먹는 작업이 진행 되므로 채점 서버의 병렬 작업 처리도 의미가 없음.
  - docker in docker 를 통해 사용자 소스코드의 제출 시간 및 메모리양도 측정해야 하므로 병렬 작업을 통해서는 해당 지표의 값을 정확하게 보장해줄 수 없음.

- **채점 서버가 사용자 제출 1건에 대해 개별적으로 전담해줄 수 있는 Aws Lambda 서비스를 적용해본다면 좋을 것 같다.**
  - 혹은, docker priviliged 모드를 사용하면서 오토 스케일링이 민첩한 컨테이너 서비스를 사용할 수 있다면 좋을 것 같다. (ex: k8s)

### 기술적용 아키텍쳐

- ARCHITECTURE-Wu22e.png 참고

